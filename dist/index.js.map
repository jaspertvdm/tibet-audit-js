{"version":3,"sources":["../src/index.ts","../src/scanner.ts","../src/checks/gdpr.ts","../src/checks/ai-act.ts","../src/checks/nis2.ts","../src/checks/pipa.ts","../src/checks/appi.ts","../src/checks/pdpa.ts","../src/checks/lgpd.ts","../src/checks/jis.ts","../src/checks/index.ts"],"sourcesContent":["/**\n * TIBET Audit - Compliance Health Scanner\n *\n * Like Lynis, but for regulations. Scan your projects for GDPR, AI Act,\n * PIPA, APPI, PDPA, LGPD, and more.\n *\n * The Diaper Protocol: One command, hands free, compliance done.\n *\n * @example\n * ```typescript\n * import { scan, getFixableIssues, applyFixes } from 'tibet-audit';\n *\n * // Basic scan\n * const result = await scan('./my-project');\n * console.log(`Score: ${result.score}/100 (Grade: ${result.grade})`);\n *\n * // Scan specific categories\n * const result = await scan('.', { categories: ['gdpr', 'ai_act'] });\n *\n * // Sovereign mode (no cloud APIs)\n * const result = await scan('.', { sovereignMode: true });\n *\n * // Fix issues\n * const fixable = getFixableIssues(result.results);\n * await applyFixes(fixable);\n * ```\n *\n * @author Jasper van de Meent & Root AI\n * @license MIT\n */\n\n// Core scanning functionality\nexport { scan, getFixableIssues, applyFixes } from './scanner';\n\n// Types\nexport type {\n  Severity,\n  Status,\n  Grade,\n  Category,\n  SignoffState,\n  FixAction,\n  CheckResult,\n  Check,\n  ScanContext,\n  ScanResult,\n  ScanOptions,\n  FixOptions,\n  SignoffRecord,\n  CheckpointResult,\n} from './types';\n\n// Checks (for advanced usage)\nexport {\n  ALL_CHECKS,\n  GDPR_CHECKS,\n  AI_ACT_CHECKS,\n  NIS2_CHECKS,\n  PIPA_CHECKS,\n  APPI_CHECKS,\n  PDPA_CHECKS,\n  LGPD_CHECKS,\n  JIS_CHECKS,\n} from './checks';\n\n// Version\nexport const VERSION = '0.2.1';\n","/**\n * TIBET Audit Scanner\n *\n * The Diaper Protocol - One command, hands free, compliance done.\n *\n * @example\n * ```typescript\n * import { scan } from 'tibet-audit';\n *\n * const result = await scan('./my-project');\n * console.log(`Score: ${result.score}/100 (Grade: ${result.grade})`);\n * ```\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport * as crypto from 'crypto';\nimport {\n  ScanResult,\n  ScanOptions,\n  ScanContext,\n  CheckResult,\n  Grade,\n  Category,\n  Check,\n} from './types';\nimport { ALL_CHECKS } from './checks';\n\n/**\n * Generate a short unique ID\n */\nfunction generateId(): string {\n  return crypto.randomBytes(4).toString('hex');\n}\n\n/**\n * Calculate grade from score\n */\nfunction calculateGrade(score: number): Grade {\n  if (score >= 90) return 'A';\n  if (score >= 80) return 'B';\n  if (score >= 70) return 'C';\n  if (score >= 60) return 'D';\n  return 'F';\n}\n\n/**\n * Read package.json if it exists\n */\nfunction readPackageJson(scanPath: string): Record<string, unknown> | undefined {\n  const pkgPath = path.join(scanPath, 'package.json');\n  if (fs.existsSync(pkgPath)) {\n    try {\n      return JSON.parse(fs.readFileSync(pkgPath, 'utf-8'));\n    } catch {\n      return undefined;\n    }\n  }\n  return undefined;\n}\n\n/**\n * Get all files in directory (non-recursive for speed)\n */\nfunction getFiles(scanPath: string): string[] {\n  const files: string[] = [];\n\n  function walkDir(dir: string, depth = 0) {\n    if (depth > 3) return; // Max 3 levels deep for speed\n    if (!fs.existsSync(dir)) return;\n\n    try {\n      const entries = fs.readdirSync(dir, { withFileTypes: true });\n      for (const entry of entries) {\n        if (entry.name.startsWith('.') || entry.name === 'node_modules') continue;\n\n        const fullPath = path.join(dir, entry.name);\n        if (entry.isDirectory()) {\n          walkDir(fullPath, depth + 1);\n        } else {\n          files.push(fullPath);\n        }\n      }\n    } catch {\n      // Permission denied, etc.\n    }\n  }\n\n  walkDir(scanPath);\n  return files;\n}\n\n/**\n * Scan a directory for compliance issues\n *\n * @param scanPath - Directory to scan (default: current directory)\n * @param options - Scan options\n * @returns Scan result with score and all check results\n *\n * @example\n * ```typescript\n * // Basic scan\n * const result = await scan('./my-project');\n *\n * // Scan specific categories\n * const result = await scan('.', { categories: ['gdpr', 'ai_act'] });\n *\n * // Sovereign mode (no cloud APIs)\n * const result = await scan('.', { sovereignMode: true });\n * ```\n */\nexport async function scan(\n  scanPath: string = '.',\n  options: ScanOptions = {}\n): Promise<ScanResult> {\n  const startTime = Date.now();\n  const resolvedPath = path.resolve(scanPath);\n\n  // Build context\n  const context: ScanContext = {\n    scanPath: resolvedPath,\n    packageJson: readPackageJson(resolvedPath),\n    files: getFiles(resolvedPath),\n    sovereignMode: options.sovereignMode ?? false,\n  };\n\n  // Filter checks by category if specified\n  let checks: Check[] = ALL_CHECKS;\n  if (options.categories && options.categories.length > 0) {\n    checks = ALL_CHECKS.filter((c) => options.categories!.includes(c.category));\n  }\n\n  // Run all checks\n  const results: CheckResult[] = [];\n  for (const check of checks) {\n    try {\n      const result = await check.run(context);\n      results.push(result);\n    } catch (error) {\n      results.push({\n        checkId: check.checkId,\n        name: check.name,\n        status: 'skipped',\n        severity: check.severity,\n        category: check.category,\n        message: `Check failed to run: ${error}`,\n        scoreImpact: 0,\n        canAutoFix: false,\n      });\n    }\n  }\n\n  // Calculate score\n  let deductions = 0;\n  for (const result of results) {\n    if (result.status === 'failed') {\n      deductions += result.scoreImpact;\n    } else if (result.status === 'warning') {\n      deductions += result.scoreImpact * 0.5;\n    }\n  }\n  const score = Math.max(0, Math.round(100 - deductions));\n  const grade = calculateGrade(score);\n\n  // Count by status\n  const passed = results.filter((r) => r.status === 'passed').length;\n  const warnings = results.filter((r) => r.status === 'warning').length;\n  const failed = results.filter((r) => r.status === 'failed').length;\n  const skipped = results.filter((r) => r.status === 'skipped').length;\n\n  return {\n    timestamp: new Date(),\n    scanPath: resolvedPath,\n    score,\n    grade,\n    passed,\n    warnings,\n    failed,\n    skipped,\n    results,\n    durationMs: Date.now() - startTime,\n    scanId: generateId(),\n    sovereignMode: options.sovereignMode ?? false,\n  };\n}\n\n/**\n * Get fixable issues from scan results\n */\nexport function getFixableIssues(results: CheckResult[]): CheckResult[] {\n  return results.filter((r) => r.canAutoFix && r.status !== 'passed');\n}\n\n/**\n * Apply fixes for issues\n */\nexport async function applyFixes(\n  issues: CheckResult[],\n  options: { dryRun?: boolean } = {}\n): Promise<{ fixed: number; failed: number }> {\n  let fixed = 0;\n  let failed = 0;\n\n  for (const issue of issues) {\n    if (!issue.fixAction?.autoFix) continue;\n\n    if (options.dryRun) {\n      console.log(`Would fix: ${issue.checkId} - ${issue.fixAction.description}`);\n      fixed++;\n      continue;\n    }\n\n    try {\n      const success = await issue.fixAction.autoFix();\n      if (success) {\n        fixed++;\n      } else {\n        failed++;\n      }\n    } catch {\n      failed++;\n    }\n  }\n\n  return { fixed, failed };\n}\n","/**\n * GDPR Compliance Checks\n *\n * EU General Data Protection Regulation\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { Check, ScanContext, CheckResult } from '../types';\n\n/**\n * Helper to check if file exists with common names\n */\nfunction findFile(context: ScanContext, patterns: string[]): string | null {\n  for (const file of context.files) {\n    const basename = path.basename(file).toLowerCase();\n    for (const pattern of patterns) {\n      if (basename.includes(pattern.toLowerCase())) {\n        return file;\n      }\n    }\n  }\n  return null;\n}\n\n/**\n * Helper to check package.json for dependency\n */\nfunction hasDependency(context: ScanContext, names: string[]): boolean {\n  if (!context.packageJson) return false;\n  const deps = {\n    ...(context.packageJson.dependencies as Record<string, string> || {}),\n    ...(context.packageJson.devDependencies as Record<string, string> || {}),\n  };\n  return names.some((name) => name in deps);\n}\n\nexport const GDPR_CHECKS: Check[] = [\n  {\n    checkId: 'GDPR-001',\n    name: 'Privacy Policy Document',\n    category: 'gdpr',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for privacy policy document',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, [\n        'privacy',\n        'privacy-policy',\n        'privacypolicy',\n        'gdpr',\n        'datenschutz',\n      ]);\n\n      if (found) {\n        return {\n          checkId: 'GDPR-001',\n          name: 'Privacy Policy Document',\n          status: 'passed',\n          severity: 'high',\n          category: 'gdpr',\n          message: `Found: ${path.basename(found)}`,\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'GDPR-001',\n        name: 'Privacy Policy Document',\n        status: 'failed',\n        severity: 'high',\n        category: 'gdpr',\n        message: 'No privacy policy document found',\n        recommendation: 'Create a PRIVACY.md or privacy-policy.md file',\n        reference: 'GDPR Article 13 & 14',\n        scoreImpact: 15,\n        canAutoFix: true,\n        fixAction: {\n          description: 'Create privacy policy template',\n          autoFix: async () => {\n            const template = `# Privacy Policy\n\n## Data Controller\n[Your Company Name]\n\n## What Data We Collect\n- [List data types]\n\n## Why We Collect It\n- [Legal basis under GDPR]\n\n## Your Rights\nUnder GDPR, you have the right to:\n- Access your data\n- Rectify inaccurate data\n- Erase your data (\"right to be forgotten\")\n- Restrict processing\n- Data portability\n- Object to processing\n\n## Contact\n[DPO contact information]\n\n## Updates\nLast updated: ${new Date().toISOString().split('T')[0]}\n`;\n            fs.writeFileSync(path.join(context.scanPath, 'PRIVACY.md'), template);\n            return true;\n          },\n        },\n      };\n    },\n  },\n\n  {\n    checkId: 'GDPR-002',\n    name: 'Data Retention Policy',\n    category: 'gdpr',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for data retention policy',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, [\n        'retention',\n        'data-retention',\n        'dataretention',\n      ]);\n\n      // Also check privacy policy for retention section\n      const privacyFile = findFile(context, ['privacy', 'gdpr']);\n      if (privacyFile) {\n        const content = fs.readFileSync(privacyFile, 'utf-8').toLowerCase();\n        if (content.includes('retention') || content.includes('how long')) {\n          return {\n            checkId: 'GDPR-002',\n            name: 'Data Retention Policy',\n            status: 'passed',\n            severity: 'high',\n            category: 'gdpr',\n            message: 'Retention policy found in privacy document',\n            scoreImpact: 0,\n            canAutoFix: false,\n          };\n        }\n      }\n\n      if (found) {\n        return {\n          checkId: 'GDPR-002',\n          name: 'Data Retention Policy',\n          status: 'passed',\n          severity: 'high',\n          category: 'gdpr',\n          message: `Found: ${path.basename(found)}`,\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'GDPR-002',\n        name: 'Data Retention Policy',\n        status: 'failed',\n        severity: 'high',\n        category: 'gdpr',\n        message: 'No data retention policy found',\n        recommendation: 'Add data retention section to privacy policy',\n        reference: 'GDPR Article 5(1)(e)',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'GDPR-003',\n    name: 'Breach Notification Procedure',\n    category: 'gdpr',\n    severity: 'critical',\n    scoreWeight: 20,\n    description: 'Check for data breach notification procedure (72 hours)',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, [\n        'breach',\n        'incident',\n        'security-incident',\n        'data-breach',\n      ]);\n\n      if (found) {\n        return {\n          checkId: 'GDPR-003',\n          name: 'Breach Notification Procedure',\n          status: 'passed',\n          severity: 'critical',\n          category: 'gdpr',\n          message: `Found: ${path.basename(found)}`,\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'GDPR-003',\n        name: 'Breach Notification Procedure',\n        status: 'failed',\n        severity: 'critical',\n        category: 'gdpr',\n        message: 'No breach notification procedure found',\n        recommendation: 'Create incident response plan (GDPR requires 72-hour notification)',\n        reference: 'GDPR Article 33 & 34',\n        scoreImpact: 20,\n        canAutoFix: true,\n        fixAction: {\n          description: 'Create breach notification template',\n          autoFix: async () => {\n            const template = `# Data Breach Response Procedure\n\n## GDPR Requirement\nNotify supervisory authority within **72 hours** of becoming aware of a breach.\n\n## Steps\n1. **Detect** - Identify the breach\n2. **Contain** - Stop further data loss\n3. **Assess** - Determine scope and impact\n4. **Notify** - Inform authorities (72h) and affected individuals\n5. **Document** - Record all actions taken\n6. **Review** - Prevent future occurrences\n\n## Notification Checklist\n- [ ] Nature of the breach\n- [ ] Categories of data affected\n- [ ] Approximate number of individuals affected\n- [ ] Contact details of DPO\n- [ ] Likely consequences\n- [ ] Measures taken to address the breach\n\n## Contacts\n- DPO: [email]\n- Supervisory Authority: [authority contact]\n- Legal Team: [contact]\n\nLast updated: ${new Date().toISOString().split('T')[0]}\n`;\n            fs.writeFileSync(path.join(context.scanPath, 'BREACH-PROCEDURE.md'), template);\n            return true;\n          },\n        },\n      };\n    },\n  },\n\n  {\n    checkId: 'GDPR-004',\n    name: 'Consent Management',\n    category: 'gdpr',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for consent management implementation',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      // Check for consent libraries in package.json\n      const consentLibs = [\n        'cookieconsent',\n        'cookie-consent',\n        'gdpr-cookie',\n        'tarteaucitron',\n        'klaro',\n        'onetrust',\n        'cookiebot',\n        'consent-manager',\n      ];\n\n      if (hasDependency(context, consentLibs)) {\n        return {\n          checkId: 'GDPR-004',\n          name: 'Consent Management',\n          status: 'passed',\n          severity: 'high',\n          category: 'gdpr',\n          message: 'Consent management library found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      // Check for consent-related files\n      const found = findFile(context, ['consent', 'cookie']);\n      if (found) {\n        return {\n          checkId: 'GDPR-004',\n          name: 'Consent Management',\n          status: 'passed',\n          severity: 'high',\n          category: 'gdpr',\n          message: `Found: ${path.basename(found)}`,\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'GDPR-004',\n        name: 'Consent Management',\n        status: 'warning',\n        severity: 'high',\n        category: 'gdpr',\n        message: 'No consent management detected',\n        recommendation: 'Implement cookie consent banner (npm: cookieconsent, klaro)',\n        reference: 'GDPR Article 7',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'GDPR-005',\n    name: 'DPO Contact Information',\n    category: 'gdpr',\n    severity: 'medium',\n    scoreWeight: 10,\n    description: 'Check for Data Protection Officer contact',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      // Check privacy policy for DPO\n      const privacyFile = findFile(context, ['privacy', 'gdpr']);\n      if (privacyFile) {\n        const content = fs.readFileSync(privacyFile, 'utf-8').toLowerCase();\n        if (\n          content.includes('dpo') ||\n          content.includes('data protection officer') ||\n          content.includes('datenschutzbeauftragter')\n        ) {\n          return {\n            checkId: 'GDPR-005',\n            name: 'DPO Contact Information',\n            status: 'passed',\n            severity: 'medium',\n            category: 'gdpr',\n            message: 'DPO information found in privacy policy',\n            scoreImpact: 0,\n            canAutoFix: false,\n          };\n        }\n      }\n\n      return {\n        checkId: 'GDPR-005',\n        name: 'DPO Contact Information',\n        status: 'warning',\n        severity: 'medium',\n        category: 'gdpr',\n        message: 'No DPO contact information found',\n        recommendation: 'Add DPO contact to privacy policy',\n        reference: 'GDPR Article 37-39',\n        scoreImpact: 10,\n        canAutoFix: false,\n      };\n    },\n  },\n];\n","/**\n * EU AI Act Compliance Checks\n *\n * Regulation on Artificial Intelligence\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { Check, ScanContext, CheckResult } from '../types';\n\n/**\n * Helper to check if file exists with common names\n */\nfunction findFile(context: ScanContext, patterns: string[]): string | null {\n  for (const file of context.files) {\n    const basename = path.basename(file).toLowerCase();\n    for (const pattern of patterns) {\n      if (basename.includes(pattern.toLowerCase())) {\n        return file;\n      }\n    }\n  }\n  return null;\n}\n\n/**\n * Helper to check package.json for dependency\n */\nfunction hasDependency(context: ScanContext, names: string[]): boolean {\n  if (!context.packageJson) return false;\n  const deps = {\n    ...(context.packageJson.dependencies as Record<string, string> || {}),\n    ...(context.packageJson.devDependencies as Record<string, string> || {}),\n  };\n  return names.some((name) => name in deps);\n}\n\n/**\n * Check if project uses AI libraries\n */\nfunction hasAILibraries(context: ScanContext): boolean {\n  const aiLibs = [\n    'openai',\n    '@anthropic-ai/sdk',\n    'anthropic',\n    '@google/generative-ai',\n    'langchain',\n    '@langchain/core',\n    'llamaindex',\n    'transformers',\n    'tensorflow',\n    '@tensorflow/tfjs',\n    'onnxruntime',\n    'ml5',\n    'brain.js',\n  ];\n  return hasDependency(context, aiLibs);\n}\n\nexport const AI_ACT_CHECKS: Check[] = [\n  {\n    checkId: 'AIACT-001',\n    name: 'AI Decision Audit Trail',\n    category: 'ai_act',\n    severity: 'critical',\n    scoreWeight: 20,\n    description: 'Check for AI decision logging/audit trail',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      // Check if project uses AI\n      if (!hasAILibraries(context)) {\n        return {\n          checkId: 'AIACT-001',\n          name: 'AI Decision Audit Trail',\n          status: 'skipped',\n          severity: 'critical',\n          category: 'ai_act',\n          message: 'No AI libraries detected',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      // Look for audit/logging files\n      const found = findFile(context, [\n        'audit',\n        'ai-log',\n        'decision-log',\n        'ml-audit',\n        'inference-log',\n      ]);\n\n      if (found) {\n        return {\n          checkId: 'AIACT-001',\n          name: 'AI Decision Audit Trail',\n          status: 'passed',\n          severity: 'critical',\n          category: 'ai_act',\n          message: `Found: ${path.basename(found)}`,\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      // Check for logging libraries\n      const loggingLibs = ['winston', 'pino', 'bunyan', 'log4js', 'tibet-vault'];\n      if (hasDependency(context, loggingLibs)) {\n        return {\n          checkId: 'AIACT-001',\n          name: 'AI Decision Audit Trail',\n          status: 'warning',\n          severity: 'critical',\n          category: 'ai_act',\n          message: 'Logging library found, but no AI-specific audit trail detected',\n          recommendation: 'Implement AI decision logging with tibet-vault for provenance',\n          scoreImpact: 10,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'AIACT-001',\n        name: 'AI Decision Audit Trail',\n        status: 'failed',\n        severity: 'critical',\n        category: 'ai_act',\n        message: 'No AI decision audit trail found',\n        recommendation: 'Implement logging for AI decisions (npm: tibet-vault)',\n        reference: 'EU AI Act Article 12 - Record-keeping',\n        scoreImpact: 20,\n        canAutoFix: true,\n        fixAction: {\n          description: 'Create AI audit trail template',\n          autoFix: async () => {\n            const template = `# AI Decision Audit Trail\n\n## Purpose\nThis document describes the logging requirements for AI decisions per EU AI Act.\n\n## What to Log\n- Input data (anonymized)\n- Model version and parameters\n- Output/decision\n- Timestamp\n- User context (if applicable)\n- Confidence scores\n\n## Implementation\n\\`\\`\\`javascript\n// Example using tibet-vault\nimport { createToken } from 'tibet-vault';\n\nasync function logAIDecision(input, output, modelInfo) {\n  await createToken({\n    type: 'ai_decision',\n    erin: { input: hash(input), output, model: modelInfo },\n    erachter: 'AI inference for user request',\n    actor: 'ai_system'\n  });\n}\n\\`\\`\\`\n\n## Retention\nAI decision logs must be retained for the lifetime of the AI system plus 10 years.\n\nLast updated: ${new Date().toISOString().split('T')[0]}\n`;\n            fs.writeFileSync(path.join(context.scanPath, 'AI-AUDIT-TRAIL.md'), template);\n            return true;\n          },\n        },\n      };\n    },\n  },\n\n  {\n    checkId: 'AIACT-002',\n    name: 'Human Oversight Mechanism',\n    category: 'ai_act',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for human oversight in AI decisions',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      if (!hasAILibraries(context)) {\n        return {\n          checkId: 'AIACT-002',\n          name: 'Human Oversight Mechanism',\n          status: 'skipped',\n          severity: 'high',\n          category: 'ai_act',\n          message: 'No AI libraries detected',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      // Look for human-in-the-loop patterns\n      const found = findFile(context, [\n        'review',\n        'approval',\n        'human-oversight',\n        'hitl',\n        'moderation',\n      ]);\n\n      if (found) {\n        return {\n          checkId: 'AIACT-002',\n          name: 'Human Oversight Mechanism',\n          status: 'passed',\n          severity: 'high',\n          category: 'ai_act',\n          message: `Found: ${path.basename(found)}`,\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'AIACT-002',\n        name: 'Human Oversight Mechanism',\n        status: 'warning',\n        severity: 'high',\n        category: 'ai_act',\n        message: 'No human oversight mechanism detected',\n        recommendation: 'Implement human review for high-risk AI decisions',\n        reference: 'EU AI Act Article 14 - Human oversight',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'AIACT-003',\n    name: 'AI Transparency Notice',\n    category: 'ai_act',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for AI transparency/disclosure',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      if (!hasAILibraries(context)) {\n        return {\n          checkId: 'AIACT-003',\n          name: 'AI Transparency Notice',\n          status: 'skipped',\n          severity: 'high',\n          category: 'ai_act',\n          message: 'No AI libraries detected',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      // Check for transparency documentation\n      const found = findFile(context, [\n        'ai-disclosure',\n        'transparency',\n        'model-card',\n        'ai-notice',\n      ]);\n\n      // Also check README\n      const readme = findFile(context, ['readme']);\n      if (readme) {\n        const content = fs.readFileSync(readme, 'utf-8').toLowerCase();\n        if (content.includes('ai') && (content.includes('powered by') || content.includes('uses'))) {\n          return {\n            checkId: 'AIACT-003',\n            name: 'AI Transparency Notice',\n            status: 'passed',\n            severity: 'high',\n            category: 'ai_act',\n            message: 'AI disclosure found in README',\n            scoreImpact: 0,\n            canAutoFix: false,\n          };\n        }\n      }\n\n      if (found) {\n        return {\n          checkId: 'AIACT-003',\n          name: 'AI Transparency Notice',\n          status: 'passed',\n          severity: 'high',\n          category: 'ai_act',\n          message: `Found: ${path.basename(found)}`,\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'AIACT-003',\n        name: 'AI Transparency Notice',\n        status: 'warning',\n        severity: 'high',\n        category: 'ai_act',\n        message: 'No AI transparency notice found',\n        recommendation: 'Add AI disclosure to README or create MODEL-CARD.md',\n        reference: 'EU AI Act Article 13 - Transparency',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'AIACT-004',\n    name: 'AI Risk Assessment',\n    category: 'ai_act',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for AI risk assessment documentation',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      if (!hasAILibraries(context)) {\n        return {\n          checkId: 'AIACT-004',\n          name: 'AI Risk Assessment',\n          status: 'skipped',\n          severity: 'high',\n          category: 'ai_act',\n          message: 'No AI libraries detected',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      const found = findFile(context, [\n        'risk-assessment',\n        'ai-risk',\n        'impact-assessment',\n        'pia',\n        'dpia',\n      ]);\n\n      if (found) {\n        return {\n          checkId: 'AIACT-004',\n          name: 'AI Risk Assessment',\n          status: 'passed',\n          severity: 'high',\n          category: 'ai_act',\n          message: `Found: ${path.basename(found)}`,\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'AIACT-004',\n        name: 'AI Risk Assessment',\n        status: 'failed',\n        severity: 'high',\n        category: 'ai_act',\n        message: 'No AI risk assessment found',\n        recommendation: 'Create AI risk assessment document',\n        reference: 'EU AI Act Article 9 - Risk management system',\n        scoreImpact: 15,\n        canAutoFix: true,\n        fixAction: {\n          description: 'Create AI risk assessment template',\n          autoFix: async () => {\n            const template = `# AI Risk Assessment\n\n## System Overview\n- **Name**: [AI System Name]\n- **Purpose**: [What the AI does]\n- **Risk Category**: [ ] Minimal [ ] Limited [ ] High [ ] Unacceptable\n\n## Risk Classification (EU AI Act)\n### High-Risk Indicators\n- [ ] Biometric identification\n- [ ] Critical infrastructure\n- [ ] Education/vocational training\n- [ ] Employment decisions\n- [ ] Essential services access\n- [ ] Law enforcement\n- [ ] Migration/asylum\n\n## Identified Risks\n| Risk | Likelihood | Impact | Mitigation |\n|------|------------|--------|------------|\n| [Risk 1] | Low/Med/High | Low/Med/High | [Mitigation] |\n\n## Mitigation Measures\n1. [Measure 1]\n2. [Measure 2]\n\n## Review Schedule\n- Next review: [Date]\n- Reviewed by: [Name]\n\nLast updated: ${new Date().toISOString().split('T')[0]}\n`;\n            fs.writeFileSync(path.join(context.scanPath, 'AI-RISK-ASSESSMENT.md'), template);\n            return true;\n          },\n        },\n      };\n    },\n  },\n];\n","/**\n * NIS2 Compliance Checks\n *\n * Network and Information Security Directive 2 (EU)\n * Deadline: 18 April 2026 for essential entities\n *\n * \"76 dagen. De tsunami komt.\"\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { Check, ScanContext, CheckResult } from '../types';\n\nfunction findFile(context: ScanContext, patterns: string[]): string | null {\n  for (const file of context.files) {\n    const basename = path.basename(file).toLowerCase();\n    for (const pattern of patterns) {\n      if (basename.includes(pattern.toLowerCase())) {\n        return file;\n      }\n    }\n  }\n  return null;\n}\n\nfunction fileContains(filePath: string, keywords: string[]): boolean {\n  try {\n    const content = fs.readFileSync(filePath, 'utf-8').toLowerCase();\n    return keywords.some((kw) => content.includes(kw.toLowerCase()));\n  } catch {\n    return false;\n  }\n}\n\n// Check for foreign cloud dependencies in config files\nfunction checkForeignCloud(context: ScanContext): { found: boolean; providers: string[] } {\n  const foreignProviders = [\n    { name: 'AWS', patterns: ['amazonaws.com', 'aws-sdk', 'aws.amazon', 's3.amazonaws'] },\n    { name: 'Azure', patterns: ['azure.com', 'microsoft.com', 'azure-sdk', 'blob.core.windows'] },\n    { name: 'Google Cloud', patterns: ['googleapis.com', 'google-cloud', 'gcp', 'storage.cloud.google'] },\n    { name: 'Cloudflare (US)', patterns: ['cloudflare.com', 'cloudflare-sdk'] },\n    { name: 'DigitalOcean', patterns: ['digitalocean.com', 'digitaloceanspaces'] },\n    { name: 'Kyndryl/IBM', patterns: ['kyndryl.com', 'ibm.com', 'softlayer'] },\n  ];\n\n  const found: string[] = [];\n\n  // Check package.json dependencies\n  if (context.packageJson) {\n    const deps = JSON.stringify(context.packageJson).toLowerCase();\n    for (const provider of foreignProviders) {\n      if (provider.patterns.some((p) => deps.includes(p))) {\n        found.push(provider.name);\n      }\n    }\n  }\n\n  // Check config files\n  const configFiles = context.files.filter((f) => {\n    const name = path.basename(f).toLowerCase();\n    return (\n      name.includes('.env') ||\n      name.includes('config') ||\n      name.endsWith('.json') ||\n      name.endsWith('.yaml') ||\n      name.endsWith('.yml')\n    );\n  });\n\n  for (const file of configFiles.slice(0, 20)) {\n    // Limit to prevent slowdown\n    try {\n      const content = fs.readFileSync(file, 'utf-8').toLowerCase();\n      for (const provider of foreignProviders) {\n        if (provider.patterns.some((p) => content.includes(p)) && !found.includes(provider.name)) {\n          found.push(provider.name);\n        }\n      }\n    } catch {\n      // Skip unreadable files\n    }\n  }\n\n  return { found: found.length > 0, providers: found };\n}\n\nexport const NIS2_CHECKS: Check[] = [\n  {\n    checkId: 'NIS2-001',\n    name: 'Risk Management Policy',\n    category: 'nis2' as any,\n    severity: 'critical',\n    scoreWeight: 15,\n    description: 'Check for risk management documentation (Article 21)',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['risk', 'security-policy', 'isms', 'risk-management']);\n\n      if (found && fileContains(found, ['risk', 'threat', 'vulnerability', 'assessment'])) {\n        return {\n          checkId: 'NIS2-001',\n          name: 'Risk Management Policy',\n          status: 'passed',\n          severity: 'critical',\n          category: 'nis2' as any,\n          message: 'Risk management documentation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'NIS2-001',\n        name: 'Risk Management Policy',\n        status: 'failed',\n        severity: 'critical',\n        category: 'nis2' as any,\n        message: 'No risk management policy found',\n        recommendation: 'Create risk management policy per NIS2 Article 21',\n        reference: 'NIS2 Article 21(2)(a)',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'NIS2-002',\n    name: 'Incident Handling Procedure',\n    category: 'nis2' as any,\n    severity: 'critical',\n    scoreWeight: 15,\n    description: 'Check for incident response plan (24h notification)',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['incident', 'response', 'breach', 'csirt']);\n\n      if (found) {\n        const has24h = fileContains(found, ['24 hour', '24-hour', '24h', 'within 24']);\n        if (has24h) {\n          return {\n            checkId: 'NIS2-002',\n            name: 'Incident Handling Procedure',\n            status: 'passed',\n            severity: 'critical',\n            category: 'nis2' as any,\n            message: 'Incident handling with 24h notification found',\n            scoreImpact: 0,\n            canAutoFix: false,\n          };\n        }\n        return {\n          checkId: 'NIS2-002',\n          name: 'Incident Handling Procedure',\n          status: 'warning',\n          severity: 'critical',\n          category: 'nis2' as any,\n          message: 'Incident procedure found but no 24h notification mentioned',\n          recommendation: 'Update procedure with 24-hour early warning requirement',\n          reference: 'NIS2 Article 23(4)(a)',\n          scoreImpact: 10,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'NIS2-002',\n        name: 'Incident Handling Procedure',\n        status: 'failed',\n        severity: 'critical',\n        category: 'nis2' as any,\n        message: 'No incident handling procedure found',\n        recommendation: 'Create incident response plan with 24h CSIRT notification',\n        reference: 'NIS2 Article 23',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'NIS2-003',\n    name: 'Supply Chain Security',\n    category: 'nis2' as any,\n    severity: 'high',\n    scoreWeight: 12,\n    description: 'Check for supply chain security measures',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['supply-chain', 'vendor', 'third-party', 'supplier']);\n\n      // Also check for package-lock.json or yarn.lock (dependency tracking)\n      const hasLockfile = context.files.some((f) => {\n        const name = path.basename(f).toLowerCase();\n        return name === 'package-lock.json' || name === 'yarn.lock' || name === 'pnpm-lock.yaml';\n      });\n\n      if (found) {\n        return {\n          checkId: 'NIS2-003',\n          name: 'Supply Chain Security',\n          status: 'passed',\n          severity: 'high',\n          category: 'nis2' as any,\n          message: 'Supply chain security documentation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      if (hasLockfile) {\n        return {\n          checkId: 'NIS2-003',\n          name: 'Supply Chain Security',\n          status: 'warning',\n          severity: 'high',\n          category: 'nis2' as any,\n          message: 'Lockfile found but no supply chain policy',\n          recommendation: 'Document supply chain security policy and vendor assessment process',\n          reference: 'NIS2 Article 21(2)(d)',\n          scoreImpact: 6,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'NIS2-003',\n        name: 'Supply Chain Security',\n        status: 'failed',\n        severity: 'high',\n        category: 'nis2' as any,\n        message: 'No supply chain security measures found',\n        recommendation: 'Implement supply chain security per NIS2 requirements',\n        reference: 'NIS2 Article 21(2)(d)',\n        scoreImpact: 12,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'NIS2-004',\n    name: 'Business Continuity',\n    category: 'nis2' as any,\n    severity: 'high',\n    scoreWeight: 12,\n    description: 'Check for business continuity / disaster recovery plan',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, [\n        'continuity',\n        'disaster',\n        'recovery',\n        'backup',\n        'bcp',\n        'drp',\n      ]);\n\n      if (found) {\n        return {\n          checkId: 'NIS2-004',\n          name: 'Business Continuity',\n          status: 'passed',\n          severity: 'high',\n          category: 'nis2' as any,\n          message: 'Business continuity plan found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'NIS2-004',\n        name: 'Business Continuity',\n        status: 'failed',\n        severity: 'high',\n        category: 'nis2' as any,\n        message: 'No business continuity plan found',\n        recommendation: 'Create BCP/DRP documentation',\n        reference: 'NIS2 Article 21(2)(c)',\n        scoreImpact: 12,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'NIS2-005',\n    name: 'Access Control Policy',\n    category: 'nis2' as any,\n    severity: 'high',\n    scoreWeight: 10,\n    description: 'Check for access control documentation',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['access', 'rbac', 'authentication', 'authorization']);\n\n      if (found) {\n        return {\n          checkId: 'NIS2-005',\n          name: 'Access Control Policy',\n          status: 'passed',\n          severity: 'high',\n          category: 'nis2' as any,\n          message: 'Access control documentation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'NIS2-005',\n        name: 'Access Control Policy',\n        status: 'warning',\n        severity: 'high',\n        category: 'nis2' as any,\n        message: 'No access control policy found',\n        recommendation: 'Document access control and authentication policies',\n        reference: 'NIS2 Article 21(2)(i)',\n        scoreImpact: 10,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'NIS2-006',\n    name: 'Encryption & Cryptography',\n    category: 'nis2' as any,\n    severity: 'high',\n    scoreWeight: 10,\n    description: 'Check for encryption policy and implementation',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['encryption', 'crypto', 'tls', 'certificate']);\n\n      // Check for TLS/SSL config\n      const hasTlsConfig = context.files.some((f) => {\n        const name = path.basename(f).toLowerCase();\n        return name.includes('ssl') || name.includes('tls') || name.includes('cert');\n      });\n\n      if (found || hasTlsConfig) {\n        return {\n          checkId: 'NIS2-006',\n          name: 'Encryption & Cryptography',\n          status: 'passed',\n          severity: 'high',\n          category: 'nis2' as any,\n          message: 'Encryption configuration found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'NIS2-006',\n        name: 'Encryption & Cryptography',\n        status: 'warning',\n        severity: 'high',\n        category: 'nis2' as any,\n        message: 'No encryption policy found',\n        recommendation: 'Document cryptography policy and ensure TLS configuration',\n        reference: 'NIS2 Article 21(2)(h)',\n        scoreImpact: 10,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'NIS2-007',\n    name: 'Vulnerability Management',\n    category: 'nis2' as any,\n    severity: 'high',\n    scoreWeight: 10,\n    description: 'Check for vulnerability disclosure and handling',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['vulnerability', 'security.md', 'security.txt', 'cve']);\n\n      // Check for security.txt\n      const hasSecurityTxt = context.files.some((f) => path.basename(f).toLowerCase() === 'security.txt');\n\n      if (found || hasSecurityTxt) {\n        return {\n          checkId: 'NIS2-007',\n          name: 'Vulnerability Management',\n          status: 'passed',\n          severity: 'high',\n          category: 'nis2' as any,\n          message: 'Vulnerability handling documentation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'NIS2-007',\n        name: 'Vulnerability Management',\n        status: 'warning',\n        severity: 'high',\n        category: 'nis2' as any,\n        message: 'No vulnerability management process found',\n        recommendation: 'Add security.txt and vulnerability disclosure process',\n        reference: 'NIS2 Article 21(2)(e)',\n        scoreImpact: 10,\n        canAutoFix: true,\n        fixAction: {\n          description: 'Create security.txt with contact info',\n          autoFix: async () => {\n            const securityTxt = `Contact: security@example.com\nExpires: 2026-12-31T23:59:00.000Z\nPreferred-Languages: en, nl\nCanonical: https://example.com/.well-known/security.txt\nPolicy: https://example.com/security-policy\n\n# NIS2 Compliance: Vulnerability Disclosure\n# Update contact info and URLs before deploying\n`;\n            try {\n              const wellKnown = path.join(context.scanPath, '.well-known');\n              if (!fs.existsSync(wellKnown)) {\n                fs.mkdirSync(wellKnown, { recursive: true });\n              }\n              fs.writeFileSync(path.join(wellKnown, 'security.txt'), securityTxt);\n              return true;\n            } catch {\n              return false;\n            }\n          },\n        },\n      };\n    },\n  },\n\n  {\n    checkId: 'NIS2-008',\n    name: 'Digital Sovereignty (no-digid)',\n    category: 'nis2' as any,\n    severity: 'high',\n    scoreWeight: 12,\n    description: 'Check for foreign cloud dependencies (US CLOUD Act risk)',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const { found, providers } = checkForeignCloud(context);\n\n      if (!found) {\n        return {\n          checkId: 'NIS2-008',\n          name: 'Digital Sovereignty (no-digid)',\n          status: 'passed',\n          severity: 'high',\n          category: 'nis2' as any,\n          message: 'No foreign cloud dependencies detected - Sovereign!',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'NIS2-008',\n        name: 'Digital Sovereignty (no-digid)',\n        status: 'warning',\n        severity: 'high',\n        category: 'nis2' as any,\n        message: `Foreign cloud detected: ${providers.join(', ')}`,\n        recommendation:\n          'Consider EU-sovereign alternatives. US CLOUD Act allows foreign access to data.',\n        reference: 'NIS2 Recital 79 (supply chain), Schrems II',\n        scoreImpact: 12,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'NIS2-009',\n    name: 'Security Awareness Training',\n    category: 'nis2' as any,\n    severity: 'medium',\n    scoreWeight: 8,\n    description: 'Check for security training documentation',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['training', 'awareness', 'onboarding', 'security-guide']);\n\n      if (found) {\n        return {\n          checkId: 'NIS2-009',\n          name: 'Security Awareness Training',\n          status: 'passed',\n          severity: 'medium',\n          category: 'nis2' as any,\n          message: 'Security training documentation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'NIS2-009',\n        name: 'Security Awareness Training',\n        status: 'warning',\n        severity: 'medium',\n        category: 'nis2' as any,\n        message: 'No security awareness training found',\n        recommendation: 'Implement cyber hygiene and security training program',\n        reference: 'NIS2 Article 21(2)(g)',\n        scoreImpact: 8,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'NIS2-010',\n    name: 'Asset Management',\n    category: 'nis2' as any,\n    severity: 'medium',\n    scoreWeight: 8,\n    description: 'Check for asset inventory',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['asset', 'inventory', 'cmdb', 'infrastructure']);\n\n      if (found) {\n        return {\n          checkId: 'NIS2-010',\n          name: 'Asset Management',\n          status: 'passed',\n          severity: 'medium',\n          category: 'nis2' as any,\n          message: 'Asset management documentation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'NIS2-010',\n        name: 'Asset Management',\n        status: 'warning',\n        severity: 'medium',\n        category: 'nis2' as any,\n        message: 'No asset inventory found',\n        recommendation: 'Create and maintain IT asset inventory',\n        reference: 'NIS2 Article 21(2)(a) - risk analysis requires asset knowledge',\n        scoreImpact: 8,\n        canAutoFix: false,\n      };\n    },\n  },\n];\n","/**\n * South Korea PIPA Compliance Checks\n *\n * Personal Information Protection Act\n * Note: PIPA has 24-hour breach notification (stricter than GDPR's 72 hours!)\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { Check, ScanContext, CheckResult } from '../types';\n\nfunction findFile(context: ScanContext, patterns: string[]): string | null {\n  for (const file of context.files) {\n    const basename = path.basename(file).toLowerCase();\n    for (const pattern of patterns) {\n      if (basename.includes(pattern.toLowerCase())) {\n        return file;\n      }\n    }\n  }\n  return null;\n}\n\nexport const PIPA_CHECKS: Check[] = [\n  {\n    checkId: 'PIPA-001',\n    name: 'Privacy Officer Designation',\n    category: 'pipa',\n    severity: 'critical',\n    scoreWeight: 20,\n    description: 'Check for designated privacy officer (CPO)',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['privacy', 'cpo', 'officer']);\n\n      if (found) {\n        const content = fs.readFileSync(found, 'utf-8').toLowerCase();\n        if (content.includes('officer') || content.includes('cpo') || content.includes('책임자')) {\n          return {\n            checkId: 'PIPA-001',\n            name: 'Privacy Officer Designation',\n            status: 'passed',\n            severity: 'critical',\n            category: 'pipa',\n            message: 'Privacy officer information found',\n            scoreImpact: 0,\n            canAutoFix: false,\n          };\n        }\n      }\n\n      return {\n        checkId: 'PIPA-001',\n        name: 'Privacy Officer Designation',\n        status: 'failed',\n        severity: 'critical',\n        category: 'pipa',\n        message: 'No Chief Privacy Officer (CPO) designation found',\n        recommendation: 'Designate and document a Chief Privacy Officer',\n        reference: 'PIPA Article 31',\n        scoreImpact: 20,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'PIPA-002',\n    name: '24-Hour Breach Notification',\n    category: 'pipa',\n    severity: 'critical',\n    scoreWeight: 20,\n    description: 'Check for 24-hour breach notification procedure (stricter than GDPR!)',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['breach', 'incident', 'notification']);\n\n      if (found) {\n        const content = fs.readFileSync(found, 'utf-8').toLowerCase();\n        if (content.includes('24') || content.includes('twenty-four')) {\n          return {\n            checkId: 'PIPA-002',\n            name: '24-Hour Breach Notification',\n            status: 'passed',\n            severity: 'critical',\n            category: 'pipa',\n            message: '24-hour breach notification procedure found',\n            scoreImpact: 0,\n            canAutoFix: false,\n          };\n        }\n        return {\n          checkId: 'PIPA-002',\n          name: '24-Hour Breach Notification',\n          status: 'warning',\n          severity: 'critical',\n          category: 'pipa',\n          message: 'Breach procedure found but 24-hour requirement not explicit',\n          recommendation: 'Update to specify 24-hour notification (PIPA requirement)',\n          scoreImpact: 10,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'PIPA-002',\n        name: '24-Hour Breach Notification',\n        status: 'failed',\n        severity: 'critical',\n        category: 'pipa',\n        message: 'No 24-hour breach notification procedure found',\n        recommendation: 'Create breach procedure with 24-hour notification (stricter than GDPR!)',\n        reference: 'PIPA Article 34',\n        scoreImpact: 20,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'PIPA-003',\n    name: 'Explicit Consent (Opt-in)',\n    category: 'pipa',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for opt-in consent mechanism',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['consent', 'opt-in', 'agreement']);\n\n      if (found) {\n        return {\n          checkId: 'PIPA-003',\n          name: 'Explicit Consent (Opt-in)',\n          status: 'passed',\n          severity: 'high',\n          category: 'pipa',\n          message: 'Consent documentation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'PIPA-003',\n        name: 'Explicit Consent (Opt-in)',\n        status: 'warning',\n        severity: 'high',\n        category: 'pipa',\n        message: 'No explicit opt-in consent mechanism found',\n        recommendation: 'Implement clear opt-in consent (PIPA requires explicit consent)',\n        reference: 'PIPA Article 15',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'PIPA-004',\n    name: 'Cross-Border Transfer Documentation',\n    category: 'pipa',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for cross-border data transfer documentation',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['transfer', 'cross-border', 'international']);\n\n      if (found) {\n        return {\n          checkId: 'PIPA-004',\n          name: 'Cross-Border Transfer Documentation',\n          status: 'passed',\n          severity: 'high',\n          category: 'pipa',\n          message: 'Cross-border transfer documentation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'PIPA-004',\n        name: 'Cross-Border Transfer Documentation',\n        status: 'warning',\n        severity: 'high',\n        category: 'pipa',\n        message: 'No cross-border transfer documentation found',\n        recommendation: 'Document data transfers outside South Korea',\n        reference: 'PIPA Article 17',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n];\n","/**\n * Japan APPI Compliance Checks\n *\n * Act on the Protection of Personal Information\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { Check, ScanContext, CheckResult } from '../types';\n\nfunction findFile(context: ScanContext, patterns: string[]): string | null {\n  for (const file of context.files) {\n    const basename = path.basename(file).toLowerCase();\n    for (const pattern of patterns) {\n      if (basename.includes(pattern.toLowerCase())) {\n        return file;\n      }\n    }\n  }\n  return null;\n}\n\nexport const APPI_CHECKS: Check[] = [\n  {\n    checkId: 'APPI-001',\n    name: 'Privacy Policy (APPI)',\n    category: 'appi',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for APPI-compliant privacy policy',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['privacy', 'プライバシー']);\n\n      if (found) {\n        return {\n          checkId: 'APPI-001',\n          name: 'Privacy Policy (APPI)',\n          status: 'passed',\n          severity: 'high',\n          category: 'appi',\n          message: `Found: ${path.basename(found)}`,\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'APPI-001',\n        name: 'Privacy Policy (APPI)',\n        status: 'failed',\n        severity: 'high',\n        category: 'appi',\n        message: 'No privacy policy found',\n        recommendation: 'Create privacy policy compliant with APPI',\n        reference: 'APPI Article 21',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'APPI-002',\n    name: 'Data Handling Records',\n    category: 'appi',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for data handling records',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['data-handling', 'records', 'processing-log']);\n\n      if (found) {\n        return {\n          checkId: 'APPI-002',\n          name: 'Data Handling Records',\n          status: 'passed',\n          severity: 'high',\n          category: 'appi',\n          message: `Found: ${path.basename(found)}`,\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'APPI-002',\n        name: 'Data Handling Records',\n        status: 'warning',\n        severity: 'high',\n        category: 'appi',\n        message: 'No data handling records found',\n        recommendation: 'Maintain records of data handling activities',\n        reference: 'APPI Article 26',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'APPI-003',\n    name: 'Cross-Border Transfer Rules',\n    category: 'appi',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for cross-border transfer compliance',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['transfer', 'cross-border', 'international']);\n\n      if (found) {\n        return {\n          checkId: 'APPI-003',\n          name: 'Cross-Border Transfer Rules',\n          status: 'passed',\n          severity: 'high',\n          category: 'appi',\n          message: 'Cross-border documentation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'APPI-003',\n        name: 'Cross-Border Transfer Rules',\n        status: 'warning',\n        severity: 'high',\n        category: 'appi',\n        message: 'No cross-border transfer documentation',\n        recommendation: 'Document transfers outside Japan with adequate protection',\n        reference: 'APPI Article 28',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'APPI-004',\n    name: 'Pseudonymization Support',\n    category: 'appi',\n    severity: 'medium',\n    scoreWeight: 10,\n    description: 'Check for pseudonymization capabilities',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['pseudonym', 'anonymize', 'mask']);\n\n      if (found) {\n        return {\n          checkId: 'APPI-004',\n          name: 'Pseudonymization Support',\n          status: 'passed',\n          severity: 'medium',\n          category: 'appi',\n          message: 'Pseudonymization documentation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'APPI-004',\n        name: 'Pseudonymization Support',\n        status: 'warning',\n        severity: 'medium',\n        category: 'appi',\n        message: 'No pseudonymization documentation',\n        recommendation: 'Consider pseudonymization for enhanced data protection',\n        reference: 'APPI Article 41',\n        scoreImpact: 10,\n        canAutoFix: false,\n      };\n    },\n  },\n];\n","/**\n * Singapore PDPA Compliance Checks\n *\n * Personal Data Protection Act\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { Check, ScanContext, CheckResult } from '../types';\n\nfunction findFile(context: ScanContext, patterns: string[]): string | null {\n  for (const file of context.files) {\n    const basename = path.basename(file).toLowerCase();\n    for (const pattern of patterns) {\n      if (basename.includes(pattern.toLowerCase())) {\n        return file;\n      }\n    }\n  }\n  return null;\n}\n\nexport const PDPA_CHECKS: Check[] = [\n  {\n    checkId: 'PDPA-001',\n    name: 'Consent Obligation',\n    category: 'pdpa',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for consent mechanism',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['consent', 'agreement', 'terms']);\n\n      if (found) {\n        return {\n          checkId: 'PDPA-001',\n          name: 'Consent Obligation',\n          status: 'passed',\n          severity: 'high',\n          category: 'pdpa',\n          message: 'Consent documentation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'PDPA-001',\n        name: 'Consent Obligation',\n        status: 'warning',\n        severity: 'high',\n        category: 'pdpa',\n        message: 'No consent mechanism found',\n        recommendation: 'Implement clear consent mechanism',\n        reference: 'PDPA Part IV',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'PDPA-002',\n    name: 'Data Protection Officer',\n    category: 'pdpa',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for DPO designation',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['dpo', 'officer', 'privacy']);\n\n      if (found) {\n        const content = fs.readFileSync(found, 'utf-8').toLowerCase();\n        if (content.includes('officer') || content.includes('dpo')) {\n          return {\n            checkId: 'PDPA-002',\n            name: 'Data Protection Officer',\n            status: 'passed',\n            severity: 'high',\n            category: 'pdpa',\n            message: 'DPO information found',\n            scoreImpact: 0,\n            canAutoFix: false,\n          };\n        }\n      }\n\n      return {\n        checkId: 'PDPA-002',\n        name: 'Data Protection Officer',\n        status: 'warning',\n        severity: 'high',\n        category: 'pdpa',\n        message: 'No DPO designation found',\n        recommendation: 'Designate a Data Protection Officer',\n        reference: 'PDPA Section 11(3)',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'PDPA-003',\n    name: '3-Day Breach Notification',\n    category: 'pdpa',\n    severity: 'critical',\n    scoreWeight: 20,\n    description: 'Check for 3-day breach notification procedure',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['breach', 'incident', 'notification']);\n\n      if (found) {\n        const content = fs.readFileSync(found, 'utf-8').toLowerCase();\n        if (content.includes('3 day') || content.includes('three day') || content.includes('72')) {\n          return {\n            checkId: 'PDPA-003',\n            name: '3-Day Breach Notification',\n            status: 'passed',\n            severity: 'critical',\n            category: 'pdpa',\n            message: 'Breach notification with timeline found',\n            scoreImpact: 0,\n            canAutoFix: false,\n          };\n        }\n      }\n\n      return {\n        checkId: 'PDPA-003',\n        name: '3-Day Breach Notification',\n        status: 'failed',\n        severity: 'critical',\n        category: 'pdpa',\n        message: 'No 3-day breach notification procedure',\n        recommendation: 'Create breach procedure with 3-day notification to PDPC',\n        reference: 'PDPA Section 26D',\n        scoreImpact: 20,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'PDPA-004',\n    name: 'Do Not Call Compliance',\n    category: 'pdpa',\n    severity: 'medium',\n    scoreWeight: 10,\n    description: 'Check for DNC registry compliance',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['dnc', 'do-not-call', 'marketing']);\n\n      if (found) {\n        return {\n          checkId: 'PDPA-004',\n          name: 'Do Not Call Compliance',\n          status: 'passed',\n          severity: 'medium',\n          category: 'pdpa',\n          message: 'DNC compliance documentation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'PDPA-004',\n        name: 'Do Not Call Compliance',\n        status: 'warning',\n        severity: 'medium',\n        category: 'pdpa',\n        message: 'No DNC registry compliance found',\n        recommendation: 'Check Singapore DNC registry before marketing calls',\n        reference: 'PDPA Part IX',\n        scoreImpact: 10,\n        canAutoFix: false,\n      };\n    },\n  },\n];\n","/**\n * Brazil LGPD Compliance Checks\n *\n * Lei Geral de Proteção de Dados\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { Check, ScanContext, CheckResult } from '../types';\n\nfunction findFile(context: ScanContext, patterns: string[]): string | null {\n  for (const file of context.files) {\n    const basename = path.basename(file).toLowerCase();\n    for (const pattern of patterns) {\n      if (basename.includes(pattern.toLowerCase())) {\n        return file;\n      }\n    }\n  }\n  return null;\n}\n\nexport const LGPD_CHECKS: Check[] = [\n  {\n    checkId: 'LGPD-001',\n    name: 'Legal Basis for Processing',\n    category: 'lgpd',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for documented legal basis',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['legal-basis', 'privacy', 'lgpd']);\n\n      if (found) {\n        const content = fs.readFileSync(found, 'utf-8').toLowerCase();\n        if (content.includes('legal basis') || content.includes('base legal') || content.includes('consent')) {\n          return {\n            checkId: 'LGPD-001',\n            name: 'Legal Basis for Processing',\n            status: 'passed',\n            severity: 'high',\n            category: 'lgpd',\n            message: 'Legal basis documentation found',\n            scoreImpact: 0,\n            canAutoFix: false,\n          };\n        }\n      }\n\n      return {\n        checkId: 'LGPD-001',\n        name: 'Legal Basis for Processing',\n        status: 'warning',\n        severity: 'high',\n        category: 'lgpd',\n        message: 'No documented legal basis for processing',\n        recommendation: 'Document legal basis per LGPD Article 7',\n        reference: 'LGPD Article 7',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'LGPD-002',\n    name: 'Encarregado (DPO)',\n    category: 'lgpd',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for Encarregado/DPO designation',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['dpo', 'encarregado', 'officer', 'privacy']);\n\n      if (found) {\n        const content = fs.readFileSync(found, 'utf-8').toLowerCase();\n        if (content.includes('encarregado') || content.includes('dpo') || content.includes('officer')) {\n          return {\n            checkId: 'LGPD-002',\n            name: 'Encarregado (DPO)',\n            status: 'passed',\n            severity: 'high',\n            category: 'lgpd',\n            message: 'Encarregado designation found',\n            scoreImpact: 0,\n            canAutoFix: false,\n          };\n        }\n      }\n\n      return {\n        checkId: 'LGPD-002',\n        name: 'Encarregado (DPO)',\n        status: 'warning',\n        severity: 'high',\n        category: 'lgpd',\n        message: 'No Encarregado (DPO) designation found',\n        recommendation: 'Designate an Encarregado (Data Protection Officer)',\n        reference: 'LGPD Article 41',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'LGPD-003',\n    name: 'Data Subject Rights (ARCO)',\n    category: 'lgpd',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for ARCO rights implementation',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['rights', 'arco', 'subject-rights']);\n\n      if (found) {\n        return {\n          checkId: 'LGPD-003',\n          name: 'Data Subject Rights (ARCO)',\n          status: 'passed',\n          severity: 'high',\n          category: 'lgpd',\n          message: 'Data subject rights documentation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'LGPD-003',\n        name: 'Data Subject Rights (ARCO)',\n        status: 'warning',\n        severity: 'high',\n        category: 'lgpd',\n        message: 'No ARCO rights implementation found',\n        recommendation: 'Implement Access, Rectification, Cancellation, Opposition rights',\n        reference: 'LGPD Article 18',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'LGPD-004',\n    name: 'Breach Notification',\n    category: 'lgpd',\n    severity: 'critical',\n    scoreWeight: 20,\n    description: 'Check for breach notification procedure',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['breach', 'incident', 'notification']);\n\n      if (found) {\n        return {\n          checkId: 'LGPD-004',\n          name: 'Breach Notification',\n          status: 'passed',\n          severity: 'critical',\n          category: 'lgpd',\n          message: 'Breach notification procedure found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'LGPD-004',\n        name: 'Breach Notification',\n        status: 'failed',\n        severity: 'critical',\n        category: 'lgpd',\n        message: 'No breach notification procedure',\n        recommendation: 'Create breach notification procedure for ANPD',\n        reference: 'LGPD Article 48',\n        scoreImpact: 20,\n        canAutoFix: false,\n      };\n    },\n  },\n];\n","/**\n * JIS Compliance Checks\n *\n * JTel Identity Standard - Bilateral consent and intent verification\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { Check, ScanContext, CheckResult } from '../types';\n\nfunction findFile(context: ScanContext, patterns: string[]): string | null {\n  for (const file of context.files) {\n    const basename = path.basename(file).toLowerCase();\n    for (const pattern of patterns) {\n      if (basename.includes(pattern.toLowerCase())) {\n        return file;\n      }\n    }\n  }\n  return null;\n}\n\nfunction hasDependency(context: ScanContext, names: string[]): boolean {\n  if (!context.packageJson) return false;\n  const deps = {\n    ...(context.packageJson.dependencies as Record<string, string> || {}),\n    ...(context.packageJson.devDependencies as Record<string, string> || {}),\n  };\n  return names.some((name) => name in deps);\n}\n\nexport const JIS_CHECKS: Check[] = [\n  {\n    checkId: 'JIS-001',\n    name: 'Bilateral Consent Implementation',\n    category: 'jis',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for bilateral consent mechanism (did:jis)',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      // Check for did-jis package\n      if (hasDependency(context, ['did-jis', '@jtel/jis', 'jis-consent'])) {\n        return {\n          checkId: 'JIS-001',\n          name: 'Bilateral Consent Implementation',\n          status: 'passed',\n          severity: 'high',\n          category: 'jis',\n          message: 'JIS bilateral consent library found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      const found = findFile(context, ['consent', 'jis', 'bilateral']);\n\n      if (found) {\n        return {\n          checkId: 'JIS-001',\n          name: 'Bilateral Consent Implementation',\n          status: 'passed',\n          severity: 'high',\n          category: 'jis',\n          message: 'Consent implementation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'JIS-001',\n        name: 'Bilateral Consent Implementation',\n        status: 'warning',\n        severity: 'high',\n        category: 'jis',\n        message: 'No bilateral consent mechanism found',\n        recommendation: 'Implement did:jis for bilateral consent (npm: did-jis)',\n        reference: 'JIS Protocol v1.0',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'JIS-002',\n    name: 'TIBET Provenance Trail',\n    category: 'jis',\n    severity: 'high',\n    scoreWeight: 15,\n    description: 'Check for TIBET provenance implementation',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      // Check for tibet packages\n      if (hasDependency(context, ['tibet-vault', 'tibet-audit', 'mcp-server-tibet'])) {\n        return {\n          checkId: 'JIS-002',\n          name: 'TIBET Provenance Trail',\n          status: 'passed',\n          severity: 'high',\n          category: 'jis',\n          message: 'TIBET provenance library found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      const found = findFile(context, ['tibet', 'provenance', 'audit-trail']);\n\n      if (found) {\n        return {\n          checkId: 'JIS-002',\n          name: 'TIBET Provenance Trail',\n          status: 'passed',\n          severity: 'high',\n          category: 'jis',\n          message: 'Provenance documentation found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'JIS-002',\n        name: 'TIBET Provenance Trail',\n        status: 'warning',\n        severity: 'high',\n        category: 'jis',\n        message: 'No TIBET provenance trail found',\n        recommendation: 'Implement TIBET for audit trail (npm: tibet-vault)',\n        reference: 'IETF draft-vandemeent-tibet-provenance',\n        scoreImpact: 15,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'JIS-003',\n    name: 'Intent Verification',\n    category: 'jis',\n    severity: 'medium',\n    scoreWeight: 10,\n    description: 'Check for intent verification (ERACHTER)',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['intent', 'erachter', 'purpose']);\n\n      if (found) {\n        return {\n          checkId: 'JIS-003',\n          name: 'Intent Verification',\n          status: 'passed',\n          severity: 'medium',\n          category: 'jis',\n          message: 'Intent verification found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'JIS-003',\n        name: 'Intent Verification',\n        status: 'warning',\n        severity: 'medium',\n        category: 'jis',\n        message: 'No explicit intent verification',\n        recommendation: 'Document the ERACHTER (intent/why) for data processing',\n        reference: 'TIBET ERACHTER principle',\n        scoreImpact: 10,\n        canAutoFix: false,\n      };\n    },\n  },\n\n  {\n    checkId: 'JIS-004',\n    name: 'Sign-off Workflow',\n    category: 'jis',\n    severity: 'medium',\n    scoreWeight: 10,\n    description: 'Check for human sign-off workflow',\n    run: async (context: ScanContext): Promise<CheckResult> => {\n      const found = findFile(context, ['signoff', 'approval', 'review']);\n\n      if (found) {\n        return {\n          checkId: 'JIS-004',\n          name: 'Sign-off Workflow',\n          status: 'passed',\n          severity: 'medium',\n          category: 'jis',\n          message: 'Sign-off workflow found',\n          scoreImpact: 0,\n          canAutoFix: false,\n        };\n      }\n\n      return {\n        checkId: 'JIS-004',\n        name: 'Sign-off Workflow',\n        status: 'skipped',\n        severity: 'medium',\n        category: 'jis',\n        message: 'No sign-off workflow (optional for non-regulated)',\n        recommendation: 'Consider --require-signoff for compliance verification',\n        reference: 'JIS Sign-off Protocol',\n        scoreImpact: 0,\n        canAutoFix: false,\n      };\n    },\n  },\n];\n","/**\n * TIBET Audit Checks\n *\n * All compliance checks across 10+ frameworks.\n * Now with NIS2 - 76 days until the tsunami!\n */\n\nimport { Check } from '../types';\nimport { GDPR_CHECKS } from './gdpr';\nimport { AI_ACT_CHECKS } from './ai-act';\nimport { NIS2_CHECKS } from './nis2';\nimport { PIPA_CHECKS } from './pipa';\nimport { APPI_CHECKS } from './appi';\nimport { PDPA_CHECKS } from './pdpa';\nimport { LGPD_CHECKS } from './lgpd';\nimport { JIS_CHECKS } from './jis';\n\nexport const ALL_CHECKS: Check[] = [\n  ...GDPR_CHECKS,\n  ...AI_ACT_CHECKS,\n  ...NIS2_CHECKS,\n  ...PIPA_CHECKS,\n  ...APPI_CHECKS,\n  ...PDPA_CHECKS,\n  ...LGPD_CHECKS,\n  ...JIS_CHECKS,\n];\n\nexport {\n  GDPR_CHECKS,\n  AI_ACT_CHECKS,\n  NIS2_CHECKS,\n  PIPA_CHECKS,\n  APPI_CHECKS,\n  PDPA_CHECKS,\n  LGPD_CHECKS,\n  JIS_CHECKS,\n};\n"],"mappings":"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","names":["fs","path","basename","fs","path","findFile","basename","hasDependency","fs","path","findFile","basename","fs","path","findFile","basename","path","findFile","basename","fs","path","findFile","basename","fs","path","findFile","basename","path","findFile","basename","hasDependency"]}